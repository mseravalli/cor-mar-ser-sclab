% COMSOL Multiphysics Model M-file
% Generated by COMSOL 3.5a (COMSOL 3.5.0.608, $Date: 2009/05/11 07:38:49 $)

flclear fem

% COMSOL version
clear vrsn
vrsn.name = 'COMSOL 3.5';
vrsn.ext = 'a';
vrsn.major = 0;
vrsn.build = 608;
vrsn.rcs = '$Name: v35ap $';
vrsn.date = '$Date: 2009/05/11 07:38:49 $';
fem.version = vrsn;

% Geometry
g1=rect2(1,1,'base','corner','pos',[0,-0.8]);
g2=rect2('2.2','0.41','base','corner','pos',{'0','0'},'rot','0');
g3=ellip2(0.2,0.2,'base','center','pos',[-0.2,-0.2]);
g4=ellip2('0.05','0.05','base','center','pos',{'0.20','0.2'},'rot','0');
g5=geomcomp({g2,g4},'ns',{'R1','E1'},'sf','R1-E1','edge','none');

% Analyzed geometry
clear s
s.objs={g5};
s.name={'CO1'};
s.tags={'g5'};

fem.draw=struct('s',s);
fem.geom=geomcsg(fem);

% Constants
fem.const = {'Umax','0.3'};

% Constants
fem.const = {'Umax','0.3'};

% Constants
fem.const = {'Umax','0.3'};

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.sshape = 2;
appl.assignsuffix = '_ns';
clear prop
prop.analysis='static';
appl.prop = prop;
clear bnd
bnd.type = 'walltype';
bnd.ind = [1,1,1,1,1,1,1,1];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% COMSOL Multiphysics Model M-file
% Generated by COMSOL 3.5a (COMSOL 3.5.0.608, $Date: 2009/05/11 07:38:49 $)

% Constants
fem.const = {'Umax','0.3'};

% Constants
fem.const = {'Umax','0.3'};

% Initialize mesh
fem.mesh=meshinit(fem, ...
                  'hauto',5);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.assignsuffix = '_ns';
clear prop
prop.analysis='static';
appl.prop = prop;
clear bnd
bnd.u0 = {0,'4*Umax*y*(0.41-y)/(0.41*0.41)'};
bnd.type = {'walltype','inlet'};
bnd.velType = {'U0in','u0'};
bnd.ind = [2,1,1,1,1,1,1,1];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Solve problem
fem.sol=femstatic(fem, ...
                  'symmetric','off', ...
                  'solcomp',{'v','u','p'}, ...
                  'outcomp',{'v','u','p'}, ...
                  'blocksize','auto', ...
                  'hnlin','on', ...
                  'linsolver','pardiso', ...
                  'uscale','none');

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'trimap','Rainbow', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-1.5347432335082853,2.274580631882268,-1.2642276422764231,1.101626016260163]);

% Initialize mesh
fem.mesh=meshinit(fem, ...
                  'hauto',5);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.assignsuffix = '_ns';
clear prop
prop.analysis='static';
appl.prop = prop;
clear bnd
bnd.u0 = {0,'4*Umax*y*(0.41-y)/(0.41*0.41)',0};
bnd.type = {'walltype','inlet','open'};
bnd.velType = {'U0in','u0','U0in'};
bnd.ind = [2,1,1,3,1,1,1,1];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Solve problem
fem.sol=femstatic(fem, ...
                  'symmetric','off', ...
                  'solcomp',{'v','u','p'}, ...
                  'outcomp',{'v','u','p'}, ...
                  'blocksize','auto', ...
                  'hnlin','on', ...
                  'linsolver','pardiso', ...
                  'uscale','none');

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'trimap','Rainbow', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-1.5347432335082853,2.274580631882268,-1.2642276422764231,1.101626016260163]);

% Initialize mesh
fem.mesh=meshinit(fem, ...
                  'hauto',5);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.assignsuffix = '_ns';
clear prop
prop.analysis='static';
appl.prop = prop;
clear bnd
bnd.u0 = {0,'4*Umax*y*(0.41-y)/(0.41*0.41)',0};
bnd.type = {'walltype','inlet','outlet'};
bnd.velType = {'U0in','u0','U0in'};
bnd.outtype = {'p','p','ntotstress'};
bnd.ind = [2,1,1,3,1,1,1,1];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Solve problem
fem.sol=femstatic(fem, ...
                  'symmetric','off', ...
                  'solcomp',{'v','u','p'}, ...
                  'outcomp',{'v','u','p'}, ...
                  'blocksize','auto', ...
                  'hnlin','on', ...
                  'linsolver','pardiso', ...
                  'uscale','none');

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'trimap','Rainbow', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-1.5347432335082853,2.274580631882268,-1.2642276422764231,1.101626016260163]);

% Initialize mesh
fem.mesh=meshinit(fem, ...
                  'hauto',5);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.assignsuffix = '_ns';
clear prop
prop.analysis='static';
appl.prop = prop;
clear bnd
bnd.u0 = {0,'4*Umax*y*(0.41-y)/(0.41*0.41)',0};
bnd.type = {'walltype','inlet','outlet'};
bnd.velType = {'U0in','u0','U0in'};
bnd.outtype = {'p','p','ntotstress'};
bnd.ind = [2,1,1,3,1,1,1,1];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Solve problem
fem=adaption(fem, ...
             'symmetric','off', ...
             'solcomp',{'v','u','p'}, ...
             'outcomp',{'v','u','p'}, ...
             'blocksize','auto', ...
             'hnlin','on', ...
             'solver','stationary', ...
             'eigselect',1, ...
             'maxt',10000000, ...
             'ngen',3, ...
             'rmethod','longest', ...
             'resorder','auto', ...
             'eefun','l2', ...
             'l2scale',1, ...
             'l2staborder',2, ...
             'tppar',1.7, ...
             'linsolver','gmres', ...
             'maxlinit',100, ...
             'uscale','none', ...
             'geomnum',1);

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'trimap','Rainbow', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-1.5347432335082853,2.274580631882268,-1.2642276422764231,1.101626016260163]);

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'triedgestyle','interp', ...
         'trifacestyle','none', ...
         'trimap','Rainbow', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.5847056538919323,0.9947056503156535]);

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'triedgestyle','interp', ...
         'trifacestyle','none', ...
         'trimap','Rainbow', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.5847056538919323,0.9947056503156535]);

% Initialize mesh
fem.mesh=meshinit(fem, ...
                  'hauto',5);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.assignsuffix = '_ns';
clear prop
prop.analysis='static';
appl.prop = prop;
clear bnd
bnd.u0 = {0,'4*Umax*y*(0.41-y)/(0.41*0.41)',0};
bnd.type = {'walltype','inlet','outlet'};
bnd.velType = {'U0in','u0','U0in'};
bnd.outtype = {'p','p','ntotstress'};
bnd.ind = [2,1,1,3,1,1,1,1];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Solve problem
fem=adaption(fem, ...
             'symmetric','off', ...
             'solcomp',{'v','u','p'}, ...
             'outcomp',{'v','u','p'}, ...
             'blocksize','auto', ...
             'hnlin','on', ...
             'solver','stationary', ...
             'eigselect',1, ...
             'maxt',10000000, ...
             'ngen',3, ...
             'rmethod','longest', ...
             'resorder','auto', ...
             'eefun','l2', ...
             'l2scale',1, ...
             'l2staborder',2, ...
             'tppar',1.7, ...
             'uscale','none', ...
             'geomnum',1);

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'triedgestyle','interp', ...
         'trifacestyle','none', ...
         'trimap','Rainbow', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.5464937287681506,0.9564937251918719]);

% Initialize mesh
fem.mesh=meshinit(fem, ...
                  'hauto',5);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.sshape = 2;
appl.assignsuffix = '_ns';
clear prop
prop.analysis='static';
appl.prop = prop;
clear bnd
bnd.u0 = {0,'4*Umax*y*(0.41-y)/(0.41*0.41)',0};
bnd.type = {'walltype','inlet','outlet'};
bnd.velType = {'U0in','u0','U0in'};
bnd.outtype = {'p','p','ntotstress'};
bnd.ind = [2,1,1,3,1,1,1,1];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.cdon = 0;
equ.sdon = 0;
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Solve problem
fem=adaption(fem, ...
             'symmetric','off', ...
             'solcomp',{'v','u','p'}, ...
             'outcomp',{'v','u','p'}, ...
             'blocksize','auto', ...
             'hnlin','on', ...
             'solver','stationary', ...
             'eigselect',1, ...
             'maxt',10000000, ...
             'ngen',3, ...
             'rmethod','longest', ...
             'resorder','auto', ...
             'eefun','l2', ...
             'l2scale',1, ...
             'l2staborder',2, ...
             'tppar',1.7, ...
             'uscale','none', ...
             'geomnum',1);

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'triedgestyle','interp', ...
         'trifacestyle','none', ...
         'trimap','Rainbow', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.5464937287681506,0.9564937251918719]);

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'triedgestyle',[0.4,0.4,0.4], ...
         'trifacestyle','none', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.5847056538919323,0.9947056503156535]);

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'triedgestyle',[0.4,0.4,0.4], ...
         'trifacestyle','none', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.5331761184166062,0.9431761148403275]);

% Plot solution
postplot(fem, ...
         'arrowdata',{'u','v'}, ...
         'arrowxspacing',15, ...
         'arrowyspacing',15, ...
         'arrowtype','arrow', ...
         'arrowstyle','proportional', ...
         'arrowcolor',[1.0,0.0,0.0], ...
         'title','Arrow: Velocity field', ...
         'axis',[-0.027499982714652815,0.6226847798053962,-0.015766516819877764,0.42704402736897784]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowlines',20, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'arrowdata',{'u','v'}, ...
         'arrowxspacing',15, ...
         'arrowyspacing',15, ...
         'arrowtype','arrow', ...
         'arrowstyle','proportional', ...
         'arrowcolor',[1.0,0.0,0.0], ...
         'title','Arrow: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowlines',20, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowlines',20, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowlines',20, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'arrowdata',{'u','v'}, ...
         'arrowxspacing',15, ...
         'arrowyspacing',15, ...
         'arrowtype','arrow', ...
         'arrowstyle','proportional', ...
         'arrowcolor',[1.0,0.0,0.0], ...
         'title','Arrow: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowlines',20, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowlines',20, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowlines',20, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowlines',20, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'arrowdata',{'u','v'}, ...
         'arrowxspacing',[0.25,0.25,0,0,0,0], ...
         'arrowyspacing',[0.19,0.23,0.19,0.22,0.15,0.25], ...
         'arrowtype','arrow', ...
         'arrowstyle','proportional', ...
         'arrowcolor',[1.0,0.0,0.0], ...
         'title','Arrow: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'arrowdata',{'u','v'}, ...
         'arrowxspacing',15, ...
         'arrowyspacing',15, ...
         'arrowtype','arrow', ...
         'arrowstyle','proportional', ...
         'arrowcolor',[1.0,0.0,0.0], ...
         'title','Arrow: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'arrowdata',{'u','v'}, ...
         'arrowxspacing',15, ...
         'arrowyspacing',15, ...
         'arrowtype','arrow', ...
         'arrowstyle','proportional', ...
         'arrowcolor',[1.0,0.0,0.0], ...
         'title','Arrow: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowstart',{[0.25,0.25,0,0,0,0],[0.19,0.23,0.19,0.22,0.15,0.25]}, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowstart',{[0.25,0.25,0,0,0,0],[0.19,0.23,0.19,0.22,0.15,0.25]}, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowstart',{[0.25,0.25,0,0,0,0],[0.19,0.23,0.19,0.22,0.15,0.25]}, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'arrowdata',{'u','v'}, ...
         'arrowxspacing',15, ...
         'arrowyspacing',15, ...
         'arrowtype','arrow', ...
         'arrowstyle','proportional', ...
         'arrowcolor',[1.0,0.0,0.0], ...
         'title','Arrow: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowstart',{[0.25,0.25,0,0,0,0],[0.19,0.23,0.19,0.22,0.15,0.25]}, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6314667353533269,1.041466731777048]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowstart',{[0.25,0.25,0,0,0,0],[0.19,0.23,0.19,0.22,0.15,0.25]}, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowstart',{[0.25,0.25,0,0,0,0],[0.19,0.23,0.19,0.22,0.15,0.25]}, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'arrowdata',{'u','v'}, ...
         'arrowxspacing',15, ...
         'arrowyspacing',15, ...
         'arrowtype','arrow', ...
         'arrowstyle','proportional', ...
         'arrowcolor',[0.2,0.2,1.0], ...
         'title','Arrow: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'flowdata',{'u','v'}, ...
         'flowcolor',[1.0,0.0,0.0], ...
         'flowstart',{[0.25,0.25,0,0,0,0],[0.19,0.23,0.19,0.22,0.15,0.25]}, ...
         'title','Streamline: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Plot solution
postplot(fem, ...
         'arrowdata',{'u','v'}, ...
         'arrowxspacing',15, ...
         'arrowyspacing',15, ...
         'arrowtype','arrow', ...
         'arrowstyle','proportional', ...
         'arrowcolor',[0.2,0.2,1.0], ...
         'title','Arrow: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% Integrate
I1=postint(fem,'p', ...
           'unit','Pa', ...
           'recover','off', ...
           'dl',7, ...
           'edim',0);

% Integrate
I2=postint(fem,'p', ...
           'unit','Pa', ...
           'recover','off', ...
           'dl',1, ...
           'edim',0);

% Integrate
I3=postint(fem,'p', ...
           'unit','Pa', ...
           'recover','off', ...
           'dl',1, ...
           'edim',0);

% Integrate
I4=postint(fem,'p', ...
           'unit','Pa', ...
           'recover','off', ...
           'dl',2, ...
           'edim',0);

% Integrate
I5=postint(fem,'p', ...
           'unit','Pa', ...
           'recover','off', ...
           'dl',3, ...
           'edim',0);

% Integrate
I6=postint(fem,'p', ...
           'unit','Pa', ...
           'recover','off', ...
           'dl',4, ...
           'edim',0);

% Integrate
I7=postint(fem,'p', ...
           'unit','Pa', ...
           'recover','off', ...
           'dl',5, ...
           'edim',0);

% Integrate
I8=postint(fem,'p', ...
           'unit','Pa', ...
           'recover','off', ...
           'dl',6, ...
           'edim',0);

% Integrate
I9=postint(fem,'p', ...
           'unit','Pa', ...
           'recover','off', ...
           'dl',7, ...
           'edim',0);

% Integrate
I10=postint(fem,'p', ...
            'unit','Pa', ...
            'recover','off', ...
            'dl',8, ...
            'edim',0);

% Integrate
I11=postint(fem,'T_x_ns', ...
            'unit','N/m', ...
            'recover','off', ...
            'dl',[5,6,7,8], ...
            'edim',1);

% Integrate
I12=postint(fem,'T_y_ns', ...
            'unit','N/m', ...
            'recover','off', ...
            'dl',[5,6,7,8], ...
            'edim',1);

% Initialize mesh
fem.mesh=meshinit(fem, ...
                  'hauto',5);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.sshape = 2;
appl.assignsuffix = '_ns';
clear prop
prop.analysis='static';
appl.prop = prop;
clear bnd
bnd.u0 = {0,'4*Umax*y*(0.41-y)/(0.41*0.41)',0};
bnd.type = {'walltype','inlet','outlet'};
bnd.velType = {'U0in','u0','U0in'};
bnd.outtype = {'p','p','ntotstress'};
bnd.ind = [2,1,1,3,1,1,1,1];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.cdon = 0;
equ.sdon = 0;
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Solve problem
fem=adaption(fem, ...
             'symmetric','off', ...
             'solcomp',{'v','u','p'}, ...
             'outcomp',{'v','u','p'}, ...
             'blocksize','auto', ...
             'hnlin','on', ...
             'solver','stationary', ...
             'eigselect',1, ...
             'maxt',10000000, ...
             'ngen',3, ...
             'rmethod','longest', ...
             'resorder','auto', ...
             'eefun','l2', ...
             'l2scale',1, ...
             'l2staborder',2, ...
             'tppar',1.7, ...
             'uscale','none', ...
             'geomnum',1);

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'arrowdata',{'u','v'}, ...
         'arrowxspacing',15, ...
         'arrowyspacing',15, ...
         'arrowtype','arrow', ...
         'arrowstyle','proportional', ...
         'arrowcolor',[0.2,0.2,1.0], ...
         'title','Arrow: Velocity field', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6314667353533269,1.041466731777048]);

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'triedgestyle','interp', ...
         'trifacestyle','none', ...
         'trimap','Rainbow', ...
         'title','Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6190746355968055,1.0290746320205268]);

% COMSOL Multiphysics Model M-file
% Generated by COMSOL 3.5a (COMSOL 3.5.0.608, $Date: 2009/05/11 07:38:49 $)

% Initialize mesh
fem.mesh=meshinit(fem, ...
                  'hauto',5);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.assignsuffix = '_ns';
clear bnd
bnd.u0 = {'4*Umax*y*(0.41-y)/(0.41*0.41)',0,0};
bnd.type = {'inlet','walltype','outlet'};
bnd.velType = {'u0','U0in','U0in'};
bnd.outtype = {'p','p','ntotstress'};
bnd.ind = [1,2,2,3,2,2,2,2];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.cdon = 0;
equ.sdon = 0;
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Solve problem
fem.sol=femtime(fem, ...
                'symmetric','off', ...
                'solcomp',{'v','u','p'}, ...
                'outcomp',{'v','u','p'}, ...
                'blocksize','auto', ...
                'odesolver','genalpha', ...
                'tlist',[colon(0,0.025,3.5)], ...
                'estrat',1, ...
                'tout','tlist', ...
                'tsteps','manual', ...
                'rhoinf',0.5, ...
                'timestep','5*dt_cfl_g1_ns', ...
                'nlsolver','manual', ...
                'ntolfact',1, ...
                'maxiter',5, ...
                'dtech','const', ...
                'damp',1.0, ...
                'jtech','once', ...
                'uscale','none');

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'triedgestyle','interp', ...
         'trifacestyle','none', ...
         'trimap','Rainbow', ...
         'solnum','end', ...
         'title','Time=3.5    Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6279261354228922,1.0379261318466135]);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.assignsuffix = '_ns';
clear bnd
bnd.u0 = {'4*Umax*y*(0.41-y)/(0.41*0.41)',0,0};
bnd.type = {'inlet','walltype','outlet'};
bnd.velType = {'u0','U0in','U0in'};
bnd.outtype = {'p','p','ntotstress'};
bnd.ind = [1,2,2,3,2,2,2,2];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.cdon = 0;
equ.sdon = 0;
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% Coupling variable elements
clear elemcpl
% Integration coupling variables
clear elem
elem.elem = 'elcplscalar';
elem.g = {'1'};
src = cell(1,1);
clear bnd
bnd.expr = {{{},'T_y_ns'}};
bnd.ipoints = {{{},'4'}};
bnd.frame = {{{},'ref'}};
bnd.ind = {{'1','2','3','4'},{'5','6','7','8'}};
src{1} = {{},bnd,{}};
elem.src = src;
geomdim = cell(1,1);
geomdim{1} = {};
elem.geomdim = geomdim;
elem.var = {'Fy'};
elem.global = {'1'};
elemcpl{1} = elem;
fem.elemcpl = elemcpl;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Mapping current solution to extended mesh
init = asseminit(fem,'init',fem0.sol,'solnum',1:solsize(fem0.sol),'blocksize','auto');

% Update model
fem.sol = init;

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'triedgestyle','interp', ...
         'trifacestyle','none', ...
         'trimap','Rainbow', ...
         'solnum','end', ...
         'title','Time=3.5    Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6155340356663709,1.025534032090092]);

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'FlNavierStokes';
appl.gporder = {4,2};
appl.cporder = {2,1};
appl.assignsuffix = '_ns';
clear bnd
bnd.u0 = {'4*Umax*y*(0.41-y)/(0.41*0.41)',0,0};
bnd.type = {'inlet','walltype','outlet'};
bnd.velType = {'u0','U0in','U0in'};
bnd.outtype = {'p','p','ntotstress'};
bnd.ind = [1,2,2,3,2,2,2,2];
appl.bnd = bnd;
clear equ
equ.eta = 0.001;
equ.gporder = {{1;1;2}};
equ.cporder = {{1;1;2}};
equ.cdon = 0;
equ.sdon = 0;
equ.ind = [1];
appl.equ = equ;
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% Coupling variable elements
clear elemcpl
% Integration coupling variables
clear elem
elem.elem = 'elcplscalar';
elem.g = {'1'};
src = cell(1,1);
clear bnd
bnd.expr = {{{},'T_y_ns'}};
bnd.ipoints = {{{},'4'}};
bnd.frame = {{{},'ref'}};
bnd.ind = {{'1','2','3','4'},{'5','6','7','8'}};
src{1} = {{},bnd,{}};
elem.src = src;
geomdim = cell(1,1);
geomdim{1} = {};
elem.geomdim = geomdim;
elem.var = {'Fy'};
elem.global = {'1'};
elemcpl{1} = elem;
fem.elemcpl = elemcpl;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;

% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Solve problem
fem.sol=femtime(fem, ...
                'symmetric','off', ...
                'solcomp',{'v','u','p'}, ...
                'outcomp',{'v','u','p'}, ...
                'blocksize','auto', ...
                'odesolver','genalpha', ...
                'tlist',[colon(0,0.025,3.5)], ...
                'estrat',1, ...
                'tout','tlist', ...
                'tsteps','manual', ...
                'rhoinf',0.5, ...
                'timestep','5*dt_cfl_g1_ns', ...
                'nlsolver','manual', ...
                'ntolfact',1, ...
                'maxiter',5, ...
                'dtech','const', ...
                'damp',1.0, ...
                'jtech','once', ...
                'uscale','none');

% Save current fem structure for restart purposes
fem0=fem;

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'triedgestyle','interp', ...
         'trifacestyle','none', ...
         'trimap','Rainbow', ...
         'solnum','end', ...
         'title','Time=3.5    Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6685747870775025,1.0785747835012238]);

% Plot solution
postplot(fem, ...
         'tridata',{'U_ns','cont','internal','unit','m/s'}, ...
         'trimap','Rainbow', ...
         'solnum','end', ...
         'title','Time=3.5    Surface: Velocity field [m/s]', ...
         'axis',[-0.1100000023841858,2.3100000500679014,-0.6685747870775025,1.0785747835012238]);

% Plot in cross-section or along domain
postcrossplot(fem,0,[3,4,5,6], ...
              'pointdata','Fy', ...
              'title','Fy', ...
              'axislabel',{'Time','Fy'}, ...
              'refine','auto');

% Plot in cross-section or along domain
postcrossplot(fem,0,[3,4,5,6], ...
              'pointdata','Fy', ...
              'title','Fy', ...
              'axislabel',{'Time','Fy'}, ...
              'refine','auto');

return; %%%%%%%%%%% END OF HISTORY %%%%%%%%%%%%%%%%%%%%%%%
%                                                        %
% M-file below is used when resetting the model.         %
%                                                        %
%%%%%%%%%%%%%% START OF RESET HISTORY %%%%%%%%%%%%%%%%%%%%



% COMSOL Multiphysics Model M-file
% Generated by COMSOL 3.5a (COMSOL 3.5.0.608, $Date: 2009/05/11 07:38:49 $)

flclear fem

% COMSOL version
clear vrsn
vrsn.name = 'COMSOL 3.5';
vrsn.ext = 'a';
vrsn.major = 0;
vrsn.build = 608;
vrsn.rcs = '$Name: v35ap $';
vrsn.date = '$Date: 2009/05/11 07:38:49 $';
fem.version = vrsn;

% Geometry
g1=rect2(1,1,'base','corner','pos',[0,-0.8]);
g2=rect2('2.2','0.41','base','corner','pos',{'0','0'},'rot','0');
g3=ellip2(0.2,0.2,'base','center','pos',[-0.2,-0.2]);
g4=ellip2('0.05','0.05','base','center','pos',{'0.20','0.2'},'rot','0');
g5=geomcomp({g2,g4},'ns',{'R1','E1'},'sf','R1-E1','edge','none');

% Analyzed geometry
clear s
s.objs={g5};
s.name={'CO1'};
s.tags={'g5'};

fem.draw=struct('s',s);
fem.geom=geomcsg(fem);

% Constants
fem.const = {'Umax','0.3'};
% COMSOL Multiphysics Model M-file
% Generated by COMSOL 3.5a (COMSOL 3.5.0.608, $Date: 2009/05/11 07:38:49 $)

% Constants
fem.const = {'Umax','0.3'};
